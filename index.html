<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VECTRA V16 | STUDIO LITE</title>
    
    <!-- LIBRARIES -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono:wght@400&family=Rajdhani:wght@500;600;700&family=Orbitron:wght@500;700;900&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg: #09090b;
            --panel: #18181b;
            --border: #27272a;
            --accent: #3b82f6;
            --text: #e4e4e7;
            --text-dim: #a1a1aa;
            --btn-bg: #27272a;
            --active-bg: #3b82f6;
        }

        body.theme-white {
            --bg: #eef2f6;
            --panel: #ffffff;
            --border: #e2e8f0;
            --accent: #d4af37;
            --text: #1e293b;
            --text-dim: #64748b;
            --btn-bg: #f1f5f9;
            --active-bg: #d4af37;
        }

        body { background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; overflow: hidden; transition: 0.3s; }
        body.theme-white { font-family: 'Cinzel', serif; }
        body.theme-white .font-tech { font-family: 'Rajdhani', sans-serif; }

        /* LAYOUT */
        .app-grid { display: grid; grid-template-columns: 350px 1fr; height: 100vh; height: 100dvh; width: 100vw; overflow: hidden; }
        .sidebar { background: var(--panel); border-right: 1px solid var(--border); display: flex; flex-direction: column; z-index: 10; overflow: hidden; }
        .main-stage { position: relative; background: #000; overflow: hidden; display: flex; flex-direction: column; }

        @media (max-width: 1024px) {
            .app-grid { grid-template-columns: 1fr; grid-template-rows: 45% 55%; }
            .sidebar { border-right: none; border-bottom: 1px solid var(--border); }
        }

        /* EDITOR */
        .editor-container { flex: 1; position: relative; min-height: 150px; }
        textarea {
            width: 100%; height: 100%; background: rgba(0,0,0,0.2); color: var(--text-dim);
            border: none; padding: 1rem; resize: none; outline: none;
            font-family: 'JetBrains Mono', monospace; font-size: 13px; line-height: 1.5;
        }
        body.theme-white textarea { background: #f8fafc; color: #334155; }

        /* CONTROLS */
        .controls { padding: 1.25rem; border-top: 1px solid var(--border); gap: 1.25rem; display: flex; flex-direction: column; overflow-y: auto; }
        .label { font-size: 0.7rem; font-weight: 700; color: var(--text-dim); letter-spacing: 0.05em; text-transform: uppercase; margin-bottom: 0.5rem; display: block; }
        
        .btn-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem; }
        .btn-grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem; }
        
        .btn {
            padding: 0.6rem; border-radius: 6px; border: 1px solid var(--border);
            background: var(--btn-bg); color: var(--text-dim); font-size: 0.8rem; font-weight: 600;
            cursor: pointer; transition: 0.2s; text-align: center; display: flex; align-items: center; justify-content: center;
            font-family: 'Rajdhani', sans-serif; flex: 1;
        }
        .btn:hover { border-color: var(--accent); color: var(--text); }
        .btn.active { background: var(--active-bg); border-color: var(--accent); color: #fff; box-shadow: 0 0 15px rgba(0,0,0,0.2); }
        
        .btn-action { background: var(--accent); color: white; border: none; padding: 0.85rem; font-size: 1rem; font-weight: 700; letter-spacing: 1px; cursor: pointer; border-radius: 6px; }
        .btn-action:hover { filter: brightness(1.1); transform: translateY(-1px); }

        /* PREVIEW AREA */
        .preview-header {
            height: 50px; background: var(--panel); border-bottom: 1px solid var(--border);
            display: flex; align-items: center; justify-content: space-between; padding: 0 1rem; flex-shrink: 0;
        }
        .preview-wrapper {
            flex: 1; overflow: auto; 
            background-color: var(--bg);
            background-image: 
                linear-gradient(45deg, rgba(128,128,128,0.05) 25%, transparent 25%), 
                linear-gradient(-45deg, rgba(128,128,128,0.05) 25%, transparent 25%), 
                linear-gradient(45deg, transparent 75%, rgba(128,128,128,0.05) 75%), 
                linear-gradient(-45deg, transparent 75%, rgba(128,128,128,0.05) 75%);
            background-size: 20px 20px;
            display: flex; justify-content: center; align-items: flex-start; padding: 40px;
            -webkit-overflow-scrolling: touch; 
        }
        
        /* FRAME CONTAINER */
        #iframeContainer {
            transform-origin: top center; transition: transform 0.2s ease-out;
            box-shadow: 0 20px 50px -10px rgba(0, 0, 0, 0.5); background: white;
        }
        iframe { border: none; background: white; display: block; }
        
        /* Range Slider */
        input[type=range] { -webkit-appearance: none; background: transparent; height: 24px; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%; background: var(--accent); margin-top: -8px; cursor: pointer; box-shadow: 0 0 5px rgba(0,0,0,0.5); }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: var(--border); border-radius: 2px; }

        /* SCROLLBARS */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
    </style>
</head>
<body>

    <div class="app-grid">
        <!-- SIDEBAR -->
        <div class="sidebar">
            <div class="p-4 border-b border-[var(--border)] flex justify-between items-center shrink-0">
                <h1 class="text-lg font-black italic tracking-wider font-[Orbitron] body.theme-white:font-[Cinzel] text-[var(--accent)]">
                    VECTRA <span class="text-[10px] opacity-50 ml-1 not-italic font-mono text-[var(--text)]">STUDIO v16</span>
                </h1>
                <button onclick="toggleTheme()" class="text-[var(--text-dim)] hover:text-[var(--accent)] transition"><i id="themeIcon" class="fa-solid fa-moon"></i></button>
            </div>
            
            <div class="editor-container">
                <textarea id="htmlInput" placeholder="<!-- Paste your HTML code here -->" spellcheck="false"></textarea>
                <div class="absolute bottom-3 right-3 flex gap-2">
                    <button onclick="pasteCode()" class="bg-[var(--btn-bg)] border border-[var(--border)] text-[var(--accent)] px-3 py-1.5 rounded text-xs font-bold hover:bg-[var(--accent)] hover:text-white transition tracking-wider shadow-lg">PASTE</button>
                    <button onclick="clearEditor()" class="bg-[var(--btn-bg)] border border-[var(--border)] text-red-400 px-3 py-1.5 rounded text-xs font-bold hover:bg-red-500 hover:text-white transition tracking-wider shadow-lg">WIPE</button>
                </div>
            </div>

            <div class="controls custom-scrollbar">
                
                <!-- Dimensions -->
                <div>
                    <div class="flex justify-between mb-2">
                        <span class="label">BASE WIDTH</span>
                        <span id="widthVal" class="text-xs font-mono text-[var(--accent)]">1920px</span>
                    </div>
                    <input type="range" id="widthSlider" min="300" max="4000" step="10" value="1920" class="w-full mb-3">
                    
                    <span class="label mt-4">PRESETS</span>
                    <div class="btn-grid-4 mb-2">
                        <button class="btn" onclick="setWidth(375)">375</button>
                        <button class="btn" onclick="setWidth(430)">430</button>
                        <button class="btn" onclick="setWidth(768)">768</button>
                        <button class="btn" onclick="setWidth(1024)">1024</button>
                    </div>
                    <div class="btn-grid-4">
                        <button class="btn" onclick="setWidth(1280)">1280</button>
                        <button class="btn" onclick="setWidth(1440)">1440</button>
                        <button class="btn active" onclick="setWidth(1920)">1920</button>
                        <button class="btn" onclick="setWidth(3840)">4K</button>
                    </div>
                    <p class="text-[10px] text-[var(--text-dim)] mt-2 leading-tight">Sets the HTML viewport width.</p>
                </div>

                <!-- Actions -->
                <div class="pt-2 mt-auto pb-4">
                    <button class="btn-action w-full shadow-lg flex items-center justify-center gap-2" onclick="openPreviewTab()">
                        <i class="fa-solid fa-external-link-alt"></i> OPEN IN NEW TAB
                    </button>
                    <p class="text-[10px] text-center text-[var(--text-dim)] mt-2">For saving: Open New Tab &rarr; Print to PDF or Screenshot.</p>
                </div>
            </div>
        </div>

        <!-- MAIN STAGE (Preview) -->
        <div class="main-stage">
            <div class="preview-header">
                <div class="flex items-center gap-3 overflow-hidden">
                    <span class="text-xs font-bold text-[var(--accent)] tracking-widest whitespace-nowrap">LIVE PREVIEW</span>
                </div>
                
                <!-- Zoom -->
                <div class="flex items-center gap-1 bg-[var(--btn-bg)] rounded border border-[var(--border)] p-0.5 shrink-0">
                    <button onclick="adjustZoom(-0.1)" class="w-7 h-7 flex items-center justify-center text-[var(--text-dim)] hover:text-[var(--text)]"><i class="fa-solid fa-minus text-[10px]"></i></button>
                    <span id="zoomLabel" class="text-[10px] font-mono w-10 text-center text-[var(--accent)]">Fit</span>
                    <button onclick="adjustZoom(0.1)" class="w-7 h-7 flex items-center justify-center text-[var(--text-dim)] hover:text-[var(--text)]"><i class="fa-solid fa-plus text-[10px]"></i></button>
                </div>
            </div>

            <div class="preview-wrapper" id="viewport">
                <div id="iframeContainer">
                    <iframe id="previewFrame" scrolling="no"></iframe>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- STATE ---
        let state = {
            width: 1920,
            zoom: 1.0,
            theme: 'galaxy'
        };

        // --- DOM ELEMENTS ---
        const els = {
            editor: document.getElementById('htmlInput'),
            iframe: document.getElementById('previewFrame'),
            container: document.getElementById('iframeContainer'),
            viewport: document.getElementById('viewport'),
            widthSlider: document.getElementById('widthSlider'),
            widthVal: document.getElementById('widthVal'),
            zoomLabel: document.getElementById('zoomLabel'),
        };

        // --- INIT ---
        window.onload = () => {
            updatePreview();
            window.addEventListener('resize', fitToScreen);
        };

        // --- LOGIC ---
        els.editor.addEventListener('input', debounce(updatePreview, 400));
        els.widthSlider.addEventListener('input', (e) => setWidth(parseInt(e.target.value)));

        function setWidth(val) {
            state.width = val;
            els.widthSlider.value = val;
            els.widthVal.innerText = val + 'px';
            
            // Update active class on buttons
            document.querySelectorAll('.btn-grid-4 .btn').forEach(btn => {
                if (parseInt(btn.innerText.replace('4K','3840')) === val) btn.classList.add('active');
                else btn.classList.remove('active');
            });

            updatePreview();
        }

        function toggleTheme() {
            state.theme = state.theme === 'galaxy' ? 'white' : 'galaxy';
            document.body.className = state.theme === 'galaxy' ? '' : 'theme-white';
            document.getElementById('themeIcon').className = state.theme === 'galaxy' ? 'fa-solid fa-moon' : 'fa-solid fa-sun';
        }

        // --- HTML GENERATOR ---
        function getHTML(width) {
            const raw = els.editor.value;
            
            // Base CSS: White background, no scrollbars, content flows naturally
            let css = `
                * { box-sizing: border-box; }
                body { margin: 0; padding: 0; background: white; overflow-x: hidden; width: ${width}px; min-height: 100vh; }
                img { max-width: 100%; height: auto; display: block; }
                ::-webkit-scrollbar { display: none; }
            `;

            // Tailwind Config Extractor
            let headContent = '';
            let bodyContent = raw;
            let userConfigScript = '';

            if (raw.toLowerCase().includes('<html')) {
                const parser = new DOMParser();
                const doc = parser.parseFromString(raw, 'text/html');
                const scripts = doc.querySelectorAll('script');
                scripts.forEach(s => {
                    if (s.textContent.includes('tailwind.config')) {
                        userConfigScript = s.outerHTML;
                        s.remove(); 
                    }
                });
                headContent = doc.head.innerHTML;
                bodyContent = doc.body.innerHTML;
            } else {
                 if (raw.includes('tailwind.config')) {
                    const match = raw.match(/<script>[\s\S]*?tailwind\.config[\s\S]*?<\/script>/);
                    if (match) {
                        userConfigScript = match[0];
                        bodyContent = raw.replace(match[0], '');
                    }
                 }
            }

            return `<!DOCTYPE html><html><head>
                <meta charset="utf-8">
                ${userConfigScript}
                <script src="https://cdn.tailwindcss.com"><\/script>
                <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
                ${headContent}
                <style>${css}</style>
                </head><body>${bodyContent}</body></html>`;
        }

        // --- PREVIEW ---
        function updatePreview() {
            const width = state.width;
            const content = getHTML(width);
            const doc = els.iframe.contentWindow.document;
            doc.open(); doc.write(content); doc.close();

            els.iframe.style.width = width + 'px';
            els.iframe.style.height = '100px';

            els.iframe.onload = () => {
                setTimeout(() => {
                    const bodyH = els.iframe.contentDocument.documentElement.scrollHeight;
                    // Allow height to be natural, no cropping, no forcing 16:9
                    els.iframe.style.height = bodyH + 'px';
                    fitToScreen();
                }, 400);
            };
        }

        function fitToScreen() {
            const w = state.width;
            const containerW = els.viewport.clientWidth - 80;
            const fitScale = Math.min(1, containerW / w);
            const totalScale = fitScale * state.zoom;
            
            els.container.style.transform = `scale(${totalScale})`;
            els.container.style.width = w + 'px';
            els.container.style.height = els.iframe.style.height;
            
            const visualH = parseInt(els.iframe.style.height) * totalScale;
            els.container.style.marginBottom = `-${parseInt(els.iframe.style.height) - visualH}px`;
            
            els.zoomLabel.innerText = `ZOOM: ${Math.round(totalScale * 100)}%`;
        }

        function adjustZoom(delta) {
            state.zoom = Math.max(0.1, state.zoom + delta);
            fitToScreen();
        }

        function openPreviewTab() {
            const width = state.width;
            const fullHTML = getHTML(width);
            const win = window.open("", "_blank");
            if (win) {
                win.document.open();
                win.document.write(fullHTML);
                win.document.close();
            } else {
                alert("Please allow pop-ups.");
            }
        }

        function debounce(func, wait) { let timeout; return function(...args) { clearTimeout(timeout); timeout = setTimeout(() => func.apply(this, args), wait); }; }
        async function pasteCode() { try { els.editor.value = await navigator.clipboard.readText(); updatePreview(); } catch(e) { alert("Use Ctrl+V"); } }
        function clearEditor() { els.editor.value = ''; updatePreview(); }

    </script>
</body>
</html>
